<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Darkroad â€“ Versione 1.7.1</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
    font-family: Arial, sans-serif;
}

/* VIDEO */
#bg-video {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 0;
}

/* START */
#start-screen {
    position: fixed;
    inset: 0;
    background: url("000.png") center / cover no-repeat;
    z-index: 10;
    cursor: pointer;
    transition: opacity 1s ease;
}

/* LAYER IMMAGINI */
#image-layer {
    position: fixed;
    inset: 0;
    z-index: 5;
    pointer-events: none;
}

/* IMMAGINI FISICHE (NO OMBRA, FILTRO LEGGERO) */
.scene-image {
    position: absolute;
    top: 50%;
    left: 50%;
    max-width: 80vw;
    max-height: 80vh;
    transform: translate(-50%, -50%) scale(1);
    transition: transform 2s cubic-bezier(.4,0,.2,1);
    
    /* FILTRO "SPORCO" LEGGERISSIMO */
    filter:
        contrast(1.03)
        saturate(0.96)
        brightness(0.98);
}

/* POSIZIONI */
.from-left   { transform: translate(-150%, -50%) scale(1); }
.from-right  { transform: translate(50%, -50%) scale(1); }
.from-top    { transform: translate(-50%, -150%) scale(1); }
.from-bottom { transform: translate(-50%, 50%) scale(1); }

/* CENTRO + MICRO-ZOOM */
.center {
    transform: translate(-50%, -50%) scale(1.03);
}

/* USCITE */
.to-left   { transform: translate(-200%, -50%) scale(1); }
.to-right  { transform: translate(100%, -50%) scale(1); }
.to-top    { transform: translate(-50%, -200%) scale(1); }
.to-bottom { transform: translate(-50%, 100%) scale(1); }

/* UI */
#version-label {
    position: fixed;
    bottom: 20px;
    right: 20px;
    color: white;
    font-size: 14px;
    opacity: 0.7;
    z-index: 20;
}

#music-toggle {
    position: fixed;
    bottom: 20px;
    left: 20px;
    z-index: 20;
    background: rgba(0,0,0,0.5);
    color: white;
    border: 1px solid rgba(255,255,255,0.3);
    padding: 8px 14px;
    font-size: 13px;
    cursor: pointer;
}

/* RIASCOLTA */
#replay {
    position: fixed;
    inset: 0;
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 30;
    background: rgba(0,0,0,0.6);
    color: white;
    font-size: 48px;
    letter-spacing: 4px;
    cursor: pointer;
}
#replay:hover {
    background: rgba(0,0,0,0.7);
}
</style>
</head>

<body>

<video id="bg-video" muted playsinline></video>

<audio id="bg-music">
    <source src="Dark Road.mp3" type="audio/mpeg">
</audio>

<div id="start-screen"></div>
<div id="image-layer"></div>

<button id="music-toggle">Pausa musica</button>
<div id="version-label">Versione 1.7.1</div>

<div id="replay">RIASCOLTA</div>

<script>
const startScreen = document.getElementById("start-screen");
const video = document.getElementById("bg-video");
const music = document.getElementById("bg-music");
const layer = document.getElementById("image-layer");
const musicBtn = document.getElementById("music-toggle");
const replay = document.getElementById("replay");

let stopped = false;

/* VIDEO */
const videos = ["video.mp4","video2.mp4","video3.mp4","video4.mp4","video5.mp4"];
let vIndex = Math.floor(Math.random() * videos.length);
video.src = videos[vIndex];
video.onended = () => {
    vIndex = (vIndex + 1) % videos.length;
    video.src = videos[vIndex];
    video.play();
};

/* DIREZIONI */
const directions = [
    { enter: "from-left",   exit: "to-right"  },
    { enter: "from-right",  exit: "to-left"   },
    { enter: "from-top",    exit: "to-bottom" },
    { enter: "from-bottom", exit: "to-top"    }
];

/* TIMELINE */
const timeline = [
    { src: "intro.png", center: 6 },
    { src: "001.png", center: 21 },
    { src: "002.png", center: 26 },
    { src: "003.png", center: 31 },
    { src: "004.png", center: 37 },
    { src: "005.png", center: 42 },
    { src: "006.png", center: 48 },
    { src: "007.png", center: 52 },
    { src: "008.png", center: 58 },
    { src: "009.png", center: 63 },
    { src: "010.png", center: 69 },
    { src: "011.png", center: 74 },
    { src: "012.png", center: 80 },
    { src: "013.png", center: 84 },
    { src: "014.png", center: 90 },
    { src: "015.png", center: 95 },
    { src: "016.png", center: 100 },
    { src: "017.png", center: 106 },
    { src: "018.png", center: 111 },
    { src: "019.png", center: 116 },
    { src: "020.png", center: 122 },
    { src: "021.png", center: 128 },
    { src: "022.png", center: 133 },
    { src: "023.png", center: 138 },
    { src: "024.png", center: 143 },
    { src: "025.png", center: 149 },
    { src: "026.png", center: 154 },
    { src: "027.png", center: 160 },
    { src: "028.png", center: 165 },
    { src: "029.png", center: 170 },
    { src: "030.png", center: 175 },
    { src: "031.png", center: 180 },
    { src: "032.png", center: 185 },
    { src: "033.png", center: 191 },
    { src: "034.png", center: 196 },
    { src: "035.png", center: 202 },
    { src: "036.png", center: 207 },
    { src: "037.png", center: 213 },
    { src: "038.png", center: 218 },
    { src: "039.png", center: 224 },
    { src: "040.png", center: 229 }
];

/* AVVIO */
startScreen.onclick = () => {
    startScreen.style.opacity = "0";
    setTimeout(() => startScreen.remove(), 1000);
    video.play();
    music.play();
    startTimeline();
};

function startTimeline() {
    timeline.forEach((item, i) => {
        const dir = directions[Math.floor(Math.random() * directions.length)];
        let img = null;

        const enterTime = (item.center - 2) * 1000;
        const next = timeline[i + 1];
        const exitTime = next ? (next.center - 2) * 1000 : null;
        const removeTime = next ? next.center * 1000 : (item.center + 2) * 1000;

        setTimeout(() => {
            if (stopped) return;
            img = document.createElement("img");
            img.src = item.src;
            img.className = `scene-image ${dir.enter}`;
            layer.appendChild(img);
            img.getBoundingClientRect();
            img.classList.add("center");
        }, enterTime);

        if (exitTime !== null) {
            setTimeout(() => {
                if (!img || stopped) return;
                img.classList.remove("center");
                img.classList.add(dir.exit);
            }, exitTime);
        }

        setTimeout(() => {
            if (img) img.remove();
        }, removeTime);
    });
}

/* MUSICA */
musicBtn.onclick = () => {
    if (music.paused) {
        music.play();
        musicBtn.textContent = "Pausa musica";
    } else {
        music.pause();
        musicBtn.textContent = "Riprendi musica";
    }
};

/* FINE BRANO */
music.onended = () => {
    stopped = true;
    video.pause();
    replay.style.display = "flex";
};

/* RIASCOLTA */
replay.onclick = () => location.reload();
</script>

</body>
</html>
